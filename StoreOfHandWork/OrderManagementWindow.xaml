<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="StoreOfHandWork.OrderManagementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Управление заказами" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="400"/>
        </Grid.ColumnDefinitions>

        <!-- Список заказов -->
        <GroupBox Grid.Row="0" Grid.Column="0" Header="Заказы" Margin="0,0,10,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Фильтры -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,10">
                    <ComboBox x:Name="StatusFilter" Width="150" Margin="0,0,10,0">
                        <ComboBoxItem Content="Все статусы"/>
                        <ComboBoxItem Content="Новый"/>
                        <ComboBoxItem Content="В обработке"/>
                        <ComboBoxItem Content="Отправлен"/>
                        <ComboBoxItem Content="Доставлен"/>
                        <ComboBoxItem Content="Отменен"/>
                    </ComboBox>
                    <TextBox x:Name="SearchBox" Width="200" Margin="0,0,10,0" 
                             Text="Поиск по номеру заказа или трек-номеру"/>
                    <Button Content="Поиск" Width="80"/>
                </StackPanel>

                <!-- Таблица заказов -->
                <DataGrid x:Name="OrdersGrid" Grid.Row="1" Margin="0,10" 
                          AutoGenerateColumns="False" IsReadOnly="True"
                          SelectionMode="Single" SelectionChanged="OrdersGrid_SelectionChanged">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="№ Заказа" Binding="{Binding OrderNumber}"/>
                        <DataGridTextColumn Header="Трек номер" Binding="{Binding TrackingNumber}"/>
                        <DataGridTextColumn Header="Дата" Binding="{Binding OrderDate, StringFormat=dd.MM.yyyy HH:mm}"/>
                        <DataGridTextColumn Header="Статус" Binding="{Binding Status}"/>
                        <DataGridTextColumn Header="Сумма" Binding="{Binding TotalAmount, StringFormat=C}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </GroupBox>

        <!-- Детали заказа и склад -->
        <GroupBox Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" Header="Детали заказа">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Информация о заказе -->
                <StackPanel Grid.Row="0" Margin="0,10">
                    <TextBlock Text="Информация о заказе:" FontWeight="Bold"/>
                    <TextBlock x:Name="OrderNumberText"/>
                    <TextBlock x:Name="TrackingNumberText"/>
                    <TextBlock x:Name="OrderDateText"/>
                    <TextBlock x:Name="StatusText"/>
                    <TextBlock x:Name="CustomerText"/>
                    <TextBlock x:Name="AddressText" TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Товары в заказе -->
                <TextBlock Grid.Row="1" Text="Состав заказа:" FontWeight="Bold" Margin="0,10"/>
                <ListBox x:Name="OrderItemsListBox" Grid.Row="2" Margin="0,10">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Image Grid.Column="0" Source="{Binding Product.ImageUrl}" 
                                       Width="50" Height="50" Margin="0,0,10,0"/>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="{Binding Product.Name}" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding Quantity, StringFormat='Количество: {0}'}"/>
                                </StackPanel>
                                <CheckBox Grid.Column="2" Content="Собран" 
                                          IsChecked="{Binding IsCollected}"
                                          Click="OrderItemCollectionChanged"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <!-- Кнопки управления -->
                <StackPanel Grid.Row="3" Margin="0,10">
                    <Button x:Name="ChangeStatusButton" Content="Изменить статус" 
                            Margin="0,5" Click="ChangeStatusButton_Click"/>
                    <Button x:Name="SetPickupAddressButton" Content="Указать адрес выдачи" 
                            Margin="0,5" Click="SetPickupAddressButton_Click"/>
                    <Button x:Name="PrintOrderButton" Content="Печать заказа" 
                            Margin="0,5" Click="PrintOrderButton_Click"/>
                </StackPanel>
            </Grid>
        </GroupBox>
    </Grid>
</Window> 